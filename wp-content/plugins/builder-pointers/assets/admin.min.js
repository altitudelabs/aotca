jQuery(function(f){var b,k,d;f("body").on("editing_module_option",function(l){if(!f("#blobs_showcase").length>0){return}b=f("#blobs_showcase");k=b.next("p.add_new").find("a");d=f("#pointers-preview");i();e()}).on("change","#themify_builder_options_setting #image_url, #themify_builder_options_setting #image_width, #themify_builder_options_setting #image_height",i).on("mousedown touchstart","#pointers-preview .blob",j).on("click touchstart","#pointers-preview img",a).on("click touchstart","#pointers .blob-delete",g);function e(){b.find("> .tb_repeatable_field").each(function(m,l){if(f(this).find('[name="left"]').val()!==""){c(f(this).find('[name="left"]').val(),f(this).find('[name="top"]').val(),++m)}})}function h(){b.find(".blob").remove()}function i(){if(d==undefined){return}var l=f("#image_url","#themify_builder_options_setting").val();if(""==l){f("#pointers").hide()}else{f.ajax({url:themifyBuilder.ajaxurl,method:"POST",data:{action:"builder_pointers_get_image",pointers_image:l,pointers_width:f("#image_width","#themify_builder_options_setting").val(),pointers_height:f("#image_height","#themify_builder_options_setting").val()},beforeSend:function(){d.find(".loading").fadeIn()},success:function(m){f("#pointers").show();d.find("img").remove();d.prepend(m)},complete:function(){d.find(".loading").fadeOut()}})}}function c(m,l,n){return f('<div class="blob" data-id="'+n+'" style="top: '+l+"%; left: "+m+'%;"><div class="blob-icon"></div></div>').appendTo(d).draggable({stop:function(r){var o=f(this);var q=(parseFloat(o.css("top"))*100)/d.height(),p=(parseFloat(o.css("left"))*100)/d.width(),s=b.find(".tb_repeatable_field:nth-child("+o.data("id")+")");f('[name="left"]',s).val(p);f('[name="top"]',s).val(q)}})}function a(n){var m=(n.offsetY*100)/f(this).height();var l=(n.offsetX*100)/f(this).width();var p=b.find(".tb_repeatable_field").length+1;k.click();c(l,m,p).trigger("mousedown");var o=b.find(".tb_repeatable_field:last-child");f('[name="left"]',o).val(l);f('[name="top"]',o).val(m)}function j(){var m=f(this).data("id");d.find(".blob").removeClass("active");f(this).addClass("active");var l=b.show().find(".tb_repeatable_field").hide().filter(":nth-child("+m+")").show();if(l.find(".blob-delete").length==0){l.append('<a class="blob-delete" href="#"><i class="fa fa-close"></i></a>')}l.find(".tf-radio-choice input[checked]").trigger("click");return false}function g(){var m=f(this).closest(".tb_repeatable_field"),l=m.index()+1;d.find('.blob[data-id="'+l+'"]').remove();m.remove();h();e();return false}});