var ytp=ytp||{};(function(a,b){a.themify_ytb={version:"3.0.8",apiKey:"",defaults:{containment:"self",ratio:"auto",videoID:null,startAt:0,stopAt:0,autoPlay:true,vol:100,addRaster:false,quality:"default",mute:false,loop:true,showYTLogo:false,mobileFallbackImage:null,optimizeDisplay:true,align:"center,center",onReady:function(c){}},controls:{play:"P",pause:"p",mute:"M",unmute:"A",onlyYT:"O",showSite:"R",ytLogo:"Y"},loading:null,locationProtocol:location.protocol,onYouTubeIframeAPIReady:function(f,c,e){var d=a(f),g={modestbranding:1,autoplay:1,controls:0,showinfo:0,rel:0,disablekb:"",fs:false,playlist:f.videoID,loop:f.opt.loop,enablejsapi:1,version:3,playerapiid:c,origin:"*",allowfullscreen:false,wmode:"transparent",iv_load_policy:3};if(document.createElement("video").canPlayType){a.extend(g,{html5:1})}f.opt.autoPlay=typeof f.opt.autoPlay==="undefined"?false:f.opt.autoPlay;f.opt.vol=f.opt.vol?f.opt.vol:100;a.themify_ytb.getDataFromAPI(f);d.on("YTPChanged",function(){f.isInit=true;var i=a("<div>").get(0);e.append(i);if(ThemifyBuilderModuleJs._isMobile()&&f.canPlayOnMobile){if(f.opt.containment.outerWidth()>a(window).width()){f.opt.containment.css({maxWidth:"100%"});var j=f.opt.containment.outerWidth()*0.563;f.opt.containment.css({maxHeight:j})}new YT.Player(i,{videoId:f.videoID.toString(),width:"100%",height:j,playerVars:g,events:{onReady:function(h){f.player=h.target}}});return}new YT.Player(i,{videoId:f.videoID.toString(),playerVars:g,events:{onReady:function(h){f.player=h.target;f.isReady=f.isPlayer&&!f.opt.autoPlay?false:true;f.playerEl=f.player.getIframe();a(f.playerEl).css({"-moz-user-select":"none","-webkit-user-select":"none","user-select":"none"}).prop("unselectable","on");d.optimizeDisplay();a(window).off("resize."+c).on("resize."+c,function(){d.optimizeDisplay()});a.themify_ytb.checkForState(f)},onStateChange:function(l){if(typeof l.target.getPlayerState!=="function"){return}var m=l.target.getPlayerState();if(f.preventTrigger){f.preventTrigger=false;return}f.state=m;var h;switch(m){case -1:h="YTPUnstarted";break;case 0:h="YTPEnd";break;case 1:h="YTPPlay";case 2:h="YTPPause";break;case 3:f.player.setPlaybackQuality(f.opt.quality);h="YTPBuffering";break;case 5:h="YTPCued";break;default:break}var k=a.Event(h);k.time=f.currentTime;if(f.canTrigger){a(f).trigger(k)}},onPlaybackQualityChange:function(k){var l=k.target.getPlaybackQuality();var h=a.Event("YTPQualityChange");h.quality=l;a(f).trigger(h)},onError:function(h){if(h.data==150){console.log("Embedding this video is restricted by Youtube.")}if(typeof f.opt.onError==="function"){f.opt.onError(d,h)}}}})})},buildPlayer:function(c){return this.each(function(){var h=this,e="themify_ytb_"+c.id,f=a(h);h.loop=0;h.opt={};h.state={};a.extend(h.opt,a.themify_ytb.defaults,c);if(!h.hasChanged){h.defaultOpt={};a.extend(h.defaultOpt,a.themify_ytb.defaults,c)}h.isRetina=(window.retina||window.devicePixelRatio>1);h.isAlone=false;h.hasFocus=true;h.videoID=c.videoID;h.defaultOpt.containment=h.opt.containment=h.opt.containment==="self"?a(this):a(h.opt.containment);var d=h.opt.containment.is(a(this));h.canPlayOnMobile=d&&a(this).children().length===0;h.isPlayer=false;if(!d){f.hide()}else{h.isPlayer=true}var i=a("<div/>").addClass("themify_ytb_wrapper big-video-wrap").attr("id","wrapper_"+e),g=a("<div/>").addClass("themify_ytb_playerbox").prop("id",e);g.appendTo(i);h.opt.containment.prepend(i);h.wrapper=i;if(ThemifyBuilderModuleJs._isMobile()&&!h.canPlayOnMobile){if(h.opt.mobileFallbackImage){h.opt.containment.css({backgroundImage:"url("+h.opt.mobileFallbackImage+")",backgroundPosition:"center center",backgroundSize:"cover",backgroundRepeat:"no-repeat"})}f.remove();a(document).trigger("YTPUnavailable");return}a.themify_ytb.onYouTubeIframeAPIReady(h,e,g)})},getDataFromAPI:function(d){d.videoData=a(d.playerEl).data("YTPlayer_data_"+d.videoID);a(d).off("YTPData.YTPlayer").on("YTPData.YTPlayer",function(){if(d.hasData){if(d.isPlayer&&!d.opt.autoPlay){var e=d.videoData.thumb_max||d.videoData.thumb_high||d.videoData.thumb_medium;d.opt.containment.css({background:"rgba(0,0,0,0.5) url("+e+") center center",backgroundSize:"cover"});d.opt.backgroundUrl=e}}});if(d.videoData){setTimeout(function(){d.opt.ratio=d.opt.ratio=="auto"?"16/9":d.opt.ratio;d.dataReceived=true;a(d).trigger("YTPChanged");var f=a.Event("YTPData");f.prop={};for(var e in d.videoData){f.prop[e]=d.videoData[e]}a(d).trigger(f)},500);d.hasData=true}else{if(a.themify_ytb.apiKey){a.getJSON(a.themify_ytb.locationProtocol+"//www.googleapis.com/youtube/v3/videos?id="+d.videoID+"&key="+a.themify_ytb.apiKey+"&part=snippet",function(h){d.dataReceived=true;a(d).trigger("YTPChanged");function g(i){d.videoData={};d.videoData.id=d.videoID;d.videoData.channelTitle=i.channelTitle;d.videoData.title=i.title;d.videoData.description=i.description.length<400?i.description:i.description.substring(0,400)+" ...";d.videoData.aspectratio=d.opt.ratio=="auto"?"16/9":d.opt.ratio;d.opt.ratio=d.videoData.aspectratio;d.videoData.thumb_max=i.thumbnails.maxres?i.thumbnails.maxres.url:null;d.videoData.thumb_high=i.thumbnails.high?i.thumbnails.high.url:null;d.videoData.thumb_medium=i.thumbnails.medium?i.thumbnails.medium.url:null;a(d.playerEl).data("YTPlayer_data_"+d.videoID,d.videoData)}g(h.items[0].snippet);d.hasData=true;var f=a.Event("YTPData");f.prop={};for(var e in d.videoData){f.prop[e]=d.videoData[e]}a(d).trigger(f)})}else{setTimeout(function(){a(d).trigger("YTPChanged")},50);if(d.isPlayer&&!d.opt.autoPlay){var c=a.themify_ytb.locationProtocol+"//i.ytimg.com/vi/"+d.videoID+"/hqdefault.jpg";d.opt.containment.css({background:"rgba(0,0,0,0.5) url("+c+") center center",backgroundSize:"cover"});d.opt.backgroundUrl=c}d.videoData=null;d.opt.ratio=d.opt.ratio=="auto"?"16/9":d.opt.ratio}}if(d.isPlayer&&!d.opt.autoPlay&&!ThemifyBuilderModuleJs._isMobile()){d.loading=a("<div/>").addClass("loading").html("Loading").hide();a(d).append(d.loading);d.loading.fadeIn()}},getVideoData:function(){return this.get(0).videoData},getVideoID:function(){return this.get(0).videoID||false},setVideoQuality:function(c){this.get(0).player.setPlaybackQuality(c)},changeMovie:function(c){var e=this.get(0);e.opt.startAt=0;e.opt.stopAt=0;e.opt.mute=false;e.opt.loop=true;e.hasData=false;e.hasChanged=true;e.player.loopTime=undefined;if(c){a.extend(e.opt,c)}e.videoID=c.videoID;var d=a.Event("YTPChangeMovie");d.time=e.currentTime;d.videoId=e.videoID;a(e).trigger(d);a(e).ThemifyYTBGetPlayer().cueVideoByUrl(encodeURI(a.themify_ytb.locationProtocol+"//www.youtube.com/v/"+e.videoID),1,e.opt.quality);a(e).optimizeDisplay();a.themify_ytb.checkForState(e);a.themify_ytb.getDataFromAPI(e)},getPlayer:function(){return a(this).get(0).player},playerDestroy:function(){var c=this.get(0);c.isInit=false;c.videoID=null;c.wrapper.remove();return this},play:function(){var c=this.get(0);if(!c.isReady){return this}c.player.playVideo();c.state=1;a(c).css("background-image","none");return this},stop:function(){var c=this.get(0);c.player.stopVideo();return this},pause:function(){var c=this.get(0);c.player.pauseVideo();c.state=2;return this},seekTo:function(c){this.get(0).player.seekTo(c,true);return this},setVolume:function(d){var c=this.get(0);c.opt.vol=d;c.player.setVolume(d);return this},mute:function(){var d=this.get(0);d.player.mute();d.player.setVolume(0);var c=a.Event("YTPMuted");c.time=d.currentTime;if(d.canTrigger){a(d).trigger(c)}return this},unmute:function(){var d=this.get(0);d.player.unMute();d.player.setVolume(d.opt.vol);var c=a.Event("YTPUnmuted");c.time=d.currentTime;if(d.canTrigger){a(d).trigger(c)}return this},checkForState:function(c){if(!a.contains(document,c)){a(c).ThemifyYTBPlayerDestroy();return}c.preventTrigger=true;c.state=2;if(c.opt.mute){a(c).ThemifyYTBMute()}c.player.playVideo();c.player.seekTo((c.opt.startAt?c.opt.startAt:1),true)},getTime:function(){return a.themify_ytb.formatTime(this.get(0).currentTime)},getTotalTime:function(){return a.themify_ytb.formatTime(this.get(0).totalTime)},setAlign:function(c){this.optimizeDisplay(c)},getAlign:function(){return this.get(0).opt.align},formatTime:function(e){var c=Math.floor(e/60),d=Math.floor(e-(60*c));return(c<=9?"0"+c:c)+" : "+(d<=9?"0"+d:d)}};a.fn.optimizeDisplay=function(g){var i=this.get(0),k={};i.opt.align=g||i.opt.align;i.opt.align=typeof i.opt.align!=="undefined "?i.opt.align:"center,center";var h=i.opt.align.split(",");if(i.opt.optimizeDisplay){var f={};var c=i.wrapper;f.width=c.outerWidth();f.height=c.outerHeight();k.width=f.width+100;k.height=i.opt.ratio==="16/9"?Math.ceil(k.width*(9/16)):Math.ceil(k.width*(3/4));k.marginTop=-((k.height-f.height)/2);k.marginLeft=0;var d=k.height<f.height;if(d){k.height=f.height;k.width=i.opt.ratio==="16/9"?Math.floor(f.height*(16/9)):Math.floor(f.height*(4/3));k.marginTop=0;k.marginLeft=-((k.width-f.width)/2)}for(var j in h){var e=h[j].replace(/ /g,"");switch(e){case"top":k.marginTop=d?-((k.height-f.height)/2):0;break;case"bottom":k.marginTop=d?0:-(k.height-f.height);break;case"left":k.marginLeft=0;break;case"right":k.marginLeft=d?-(k.width-f.width):0;break;default:break}}}else{k.width="100%";k.height="100%";k.marginTop=0;k.marginLeft=0}a(i.playerEl).css({width:k.width,height:k.height,marginTop:k.marginTop,marginLeft:k.marginLeft})};a.fn.ThemifyYTBPlayer=a.themify_ytb.buildPlayer;a.fn.ThemifyYTBGetPlayer=a.themify_ytb.getPlayer;a.fn.ThemifyYTBGetVideoID=a.themify_ytb.getVideoID;a.fn.ThemifyYTBChangeMovie=a.themify_ytb.changeMovie;a.fn.ThemifyYTBPlayerDestroy=a.themify_ytb.playerDestroy;a.fn.ThemifyYTBPlay=a.themify_ytb.play;a.fn.ThemifyYTBStop=a.themify_ytb.stop;a.fn.ThemifyYTBPause=a.themify_ytb.pause;a.fn.ThemifyYTBSeekTo=a.themify_ytb.seekTo;a.fn.ThemifyYTBMute=a.themify_ytb.mute;a.fn.ThemifyYTBUnmute=a.themify_ytb.unmute;a.fn.ThemifyYTBSetVolume=a.themify_ytb.setVolume;a.fn.ThemifyYTBGetVideoData=a.themify_ytb.getVideoData;a.fn.ThemifyYTBSetVideoQuality=a.themify_ytb.setVideoQuality;a.fn.ThemifyYTBGetTime=a.themify_ytb.getTime;a.fn.ThemifyYTBGetTotalTime=a.themify_ytb.getTotalTime;a.fn.ThemifyYTBSetAlign=a.themify_ytb.setAlign;a.fn.ThemifyYTBGetAlign=a.themify_ytb.getAlign})(jQuery,ytp);