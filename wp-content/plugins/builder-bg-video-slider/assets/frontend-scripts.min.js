var SliderVideos,SV_VisibilityHelper;(function(c,b,a,d){SV_VisibilityHelper={browserPrefixes:["moz","ms","o","webkit"],getHiddenPropertyName:function(e){return(e?e+"Hidden":"hidden")},getVisibilityEvent:function(e){return(e?e:"")+"visibilitychange"},getBrowserPrefix:function(){var e=SV_VisibilityHelper;for(var f=0;f<e.browserPrefixes.length;f++){if(e.getHiddenPropertyName(e.browserPrefixes[f]) in a){return e.browserPrefixes[f]}}return null}};SliderVideos={hiddenPropertyName:SV_VisibilityHelper.getHiddenPropertyName(SV_VisibilityHelper.getBrowserPrefix()),visibilityEventName:SV_VisibilityHelper.getVisibilityEvent(SV_VisibilityHelper.getBrowserPrefix()),isVisible:false,videos:{},init:function(){var e=SliderVideos;e.bindEvents()},bindEvents:function(){var e=SliderVideos;if(b.loaded){e.windowLoad()}else{c(b).load(e.windowLoad)}c(a).on("builder_load_on_ajax builder_slider_videos_loaded","body",e.windowLoad).on(e.visibilityEventName,e.handleVisibilityChange).focus(function(){e.handleVisibilityChange(true)}).blur(function(){e.handleVisibilityChange(false)});c(b).focus(function(){e.handleVisibilityChange(true)}).blur(function(){e.handleVisibilityChange(false)})},windowLoad:function(){var e=SliderVideos;e.moveSlider();e.makeSlider();e.sliderEvents();e.handleVisibilityChange()},windowFocus:function(){var e=SliderVideos;if(e.isVisible){return}e.isVisible=true;c("body").addClass("tb_slider_videos_window_focus");c(".tb_slider_videos.tb_slider_videos_waiting_to_run_next_slide").each(function(){var f=c(this);f.removeClass("tb_slider_videos_waiting_to_run_next_slide");f.data("swiper").slideNext()})},windowBlur:function(){var e=SliderVideos;if(!e.isVisible){return}e.isVisible=false;c("body").removeClass("tb_slider_videos_window_focus")},handleVisibilityChange:function(f){var e=SliderVideos;if(typeof f==="boolean"){if(f){return e.windowFocus()}return e.windowBlur()}if(a[e.hiddenPropertyName]){return e.windowBlur()}return e.windowFocus()},moveSlider:function(){c(".tb_slider_videos:not(.tb_slider_videos_moved)").each(function(){var f=c(this).closest(".module_row"),e=c(this).siblings(".tb_slider_videos_helper").detach();c(this).detach().addClass("tb_slider_videos_moved").appendTo(f);e.addClass("tb_slider_videos_helper_moved").appendTo(f)})},makeSlider:function(){var e=SliderVideos,f=c(".tb_slider_videos");if(f.length>0){Themify.LoadAsync(themify_vars.url+"/js/jquery.imagesloaded.min.js",function(){Themify.LoadAsync(themify_vars.url+"/js/video.js",function(){Themify.LoadAsync(themify_vars.url+"/js/bigvideo.js",function(){Themify.LoadAsync(tb_slider_videos_vars.url+"assets/swiper.jquery.min.js",function(){e.makeSliderCallBack(f)},null,null,function(){return("undefined"!==typeof c.fn.swiper)})},null,null,function(){return("undefined"!==typeof c.BigVideo)})},null,null,function(){return("undefined"!==typeof videojs)})},null,null,function(){return"undefined"!==typeof c.fn.imagesLoaded})}},makeSliderCallBack:function(e){c.each(e,function(j,l){var g=SliderVideos,k=c(l),h=k.attr("data-index"),f=k.siblings(".tb_slider_videos_nav");if(typeof g.videos[h]=="undefined"){g.videos[h]={}}k.swiper({effect:"fade",fade:{crossFade:true},speed:500,setWrapperSize:true,loop:true,pagination:k.siblings(".tb_slider_videos_pagination"),paginationClickable:true,prevButton:f.children(".tb_slider_videos_nav_arrow_prev"),nextButton:f.children(".tb_slider_videos_nav_arrow_next"),onInit:function(i){c(i.container).closest(".themify_builder_row").css({position:"relative","z-index":0,background:"none"})},onSlideChangeStart:function(v){if(c("body").hasClass("builder-is-mobile")){return}var t=c(v.container),u=t.attr("data-index"),q=t.attr("data-progressbar"),w=t.attr("data-controls"),o=t.attr("data-mute"),n=t.attr("data-autoplay"),i,s;i=c(t.find(".tb_slider_videos_slide").get(v.previousIndex)),s=i.attr("data-index");if(q=="show"){t.siblings(".tb_slider_videos_progressbar").find(".vjs-progress-control-"+s).fadeOut(500)}else{t.siblings(".tb_slider_videos_progressbar").hide()}var r=t.siblings(".tb_slider_videos_nav"),m=r.children(".tb_slider_videos_nav_control_play"),x=r.children(".tb_slider_videos_nav_control_pause");if(w=="hide"){r.hide()}if(typeof g.videos[u][s]!="undefined"&&g.videos[u][s]!=null){g.videos[u][s].getPlayer().pause()}i=c(t.find(".tb_slider_videos_slide").get(v.activeIndex)),s=i.attr("data-index");if(typeof g.videos[u][s]=="undefined"||g.videos[u][s]==null){g.videos[u][s]=new c.BigVideo({doLoop:false,ambient:o=="yes",container:i,poster:i.attr("data-image")});g.videos[u][s].init();var p=g.videos[u][s].getPlayer().pause();p.on("loadedmetadata",function(){var y=c(this.el());if(y.length>0&&y.find("video").length>0){y.find("video").css("opacity","1")}});p.on(["waiting","seeking"],function(){m.addClass("loading");x.addClass("loading")});p.on(["canplay","canplaythrough","playing","ended","seeked"],function(){m.removeClass("loading");x.removeClass("loading")});p.on("play",function(){m.hide();x.show()});p.on("pause",function(){m.show();x.hide()});if(q=="show"){p.on("loadedmetadata",function(){var B=c(this.el()),z=B.find(".vjs-progress-control").detach(),A=B.closest(".tb_slider_videos_slide").attr("data-index"),y=B.closest(".tb_slider_videos").siblings(".tb_slider_videos_progressbar");z.addClass("vjs-progress-control-"+A).hide();y.append(z);z.fadeIn(500)})}p.on("loadedmetadata",function(){c(this.el()).find(".vjs-poster, .vjs-text-track-display, .vjs-loading-spinner, .vjs-big-play-button, .vjs-control-bar, .vjs-error-display").remove()});p.on("ended",function(){if(c(this.el()).closest(".tb_slider_videos_slide.swiper-slide-active").length==1){if(c("body").hasClass("tb_slider_videos_window_focus")){if(v.bullets.length!==1){v.slideNext()}else{if(n=="yes"){g.videos[u][s].show(i.attr("data-video"))}}}else{t.addClass("tb_slider_videos_waiting_to_run_next_slide")}}});if(n=="yes"){g.videos[u][s].show(i.attr("data-video"))}else{i.attr("data-video-waiting",i.attr("data-video"))}}if(v.bullets.length==1){c(v.container).parent().find(".tb_slider_videos_pagination").hide();c(v.container).parent().find(".tb_slider_videos_nav_arrow").hide();c(v.container).parent().find(".tb_slider_videos_nav").css("width",50)}},onSlideChangeEnd:function(i){if(c("body").hasClass("builder-is-mobile")){return}var p=c(i.container),n=p.attr("data-index"),m,o;m=c(p.find(".tb_slider_videos_slide").get(i.previousIndex)),o=m.attr("data-index");if(typeof g.videos[n][o]!="undefined"&&g.videos[n][o]!=null&&i.bullets.length!==1){g.videos[n][o].getPlayer().pause();setTimeout(function(){delete g.videos[n][o].getPlayer();g.videos[n][o]=null},0)}p.find(".tb_slider_videos_slide:not(.swiper-slide-active)").html("");p.siblings(".tb_slider_videos_progressbar").find(".vjs-progress-control-"+o).remove()}})})},sliderEvents:function(){var e=SliderVideos;c(a).off("click",".tb_slider_videos_nav_control_play:not(.loading)",e.sliderEventsPlay).on("click",".tb_slider_videos_nav_control_play:not(.loading)",e.sliderEventsPlay).off("click",".tb_slider_videos_nav_control_pause:not(.loading)",e.sliderEventsPause).on("click",".tb_slider_videos_nav_control_pause:not(.loading)",e.sliderEventsPause)},sliderEventsPlay:function(){var e=SliderVideos,j=c(this),h=j.closest(".tb_slider_videos_nav").siblings(".tb_slider_videos"),f=h.find(".tb_slider_videos_slide.swiper-slide-active"),g=h.attr("data-index"),i=f.attr("data-index");if(typeof e.videos[g][i]!="undefined"&&e.videos[g][i]!=null&&f.attr("data-video-waiting")){e.videos[g][i].show(f.attr("data-video-waiting"));f.removeAttr("data-video-waiting")}else{if(typeof e.videos[g][i]!="undefined"&&e.videos[g][i]!=null){e.videos[g][i].getPlayer().play()}}j.hide();j.siblings(".tb_slider_videos_nav_control_pause").show()},sliderEventsPause:function(){var e=SliderVideos,j=c(this),h=j.closest(".tb_slider_videos_nav").siblings(".tb_slider_videos"),f=h.find(".tb_slider_videos_slide.swiper-slide-active"),g=h.attr("data-index"),i=f.attr("data-index");if(typeof e.videos[g][i]!="undefined"&&e.videos[g][i]!=null){e.videos[g][i].getPlayer().pause()}j.hide();j.siblings(".tb_slider_videos_nav_control_play").show()}};SliderVideos.init()}(jQuery,window,document));