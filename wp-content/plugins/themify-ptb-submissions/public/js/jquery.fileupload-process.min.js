!function(a){"function"==typeof define&&define.amd?define(["jquery","./jquery.fileupload"],a):a("object"==typeof exports?require("jquery"):window.jQuery)}(function(b){var a=b.blueimp.fileupload.prototype.options.add;b.widget("blueimp.fileupload",b.blueimp.fileupload,{options:{processQueue:[],add:function(d,c){var e=b(this);c.process(function(){return e.fileupload("process",c)}),a.call(this,d,c)}},processActions:{},_processFile:function(e,f){var d=this,g=b.Deferred().resolveWith(d,[e]),c=g.promise();return this._trigger("process",null,e),b.each(e.processQueue,function(h,i){var j=function(k){return f.errorThrown?b.Deferred().rejectWith(d,[f]).promise():d.processActions[i.action].call(d,k,i)};c=c.pipe(j,i.always&&j)}),c.done(function(){d._trigger("processdone",null,e),d._trigger("processalways",null,e)}).fail(function(){d._trigger("processfail",null,e),d._trigger("processalways",null,e)}),c},_transformProcessQueue:function(c){var d=[];b.each(c.processQueue,function(){var f={},g=this.action,e=this.prefix===!0?g:this.prefix;b.each(this,function(h,i){"string"===b.type(i)&&"@"===i.charAt(0)?f[h]=c[i.slice(1)||(e?e+h.charAt(0).toUpperCase()+h.slice(1):h)]:f[h]=i}),d.push(f)}),c.processQueue=d},processing:function(){return this._processing},process:function(d){var e=this,c=b.extend({},this.options,d);return c.processQueue&&c.processQueue.length&&(this._transformProcessQueue(c),0===this._processing&&this._trigger("processstart"),b.each(d.files,function(g){var f=g?b.extend({},c):c,h=function(){return d.errorThrown?b.Deferred().rejectWith(e,[d]).promise():e._processFile(f,d)};f.index=g,e._processing+=1,e._processingQueue=e._processingQueue.pipe(h,h).always(function(){e._processing-=1,0===e._processing&&e._trigger("processstop")})})),this._processingQueue},_create:function(){this._super(),this._processing=0,this._processingQueue=b.Deferred().resolveWith(this).promise()}})});