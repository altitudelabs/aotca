(function(c){function b(g,f){f=f.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var i=new RegExp("[\\?&]"+f+"=([^&#]*)"),h=i.exec(g);return h===null?"":decodeURIComponent(h[1].replace(/\+/g," "))}var d=function(f){f.chosen({disable_search_threshold:7,search_contains:true,width:"100%"}).on("change",function(g,h){c(g.currentTarget).find("option:not(:first)").prop("disabled",h.selected==="all").trigger("chosen:updated")}).on("chosen:showing_dropdown",function(g){c(g.currentTarget).closest(".ptb_dragged").css("z-index",110)}).on("chosen:hiding_dropdown",function(g){c(g.currentTarget).closest(".ptb_dragged").css("z-index",100)})};var e=function(){var g=c("#ptb-submission-list-form #the-list");var f=g.closest("form");c.ajax({url:ajaxurl,type:"POST",data:{action:"ptb_submission_list"},beforeSend:function(){f.addClass("ptb-frontend-wait")},complete:function(){f.removeClass("ptb-frontend-wait")},success:function(h){if(h){h=c(h).find("#the-list").html();g.html(h)}}})};c(document).on("PTB.close_lightbox",function(h,g){var f=c(g).next("#ptb_lightbox_container");if(f.find("#ptb-submission-edit-form").length>0){e()}});c(document).on("PTB.template_drag_end",function(k,h,j,f){if(f!=="frontend"){return false}var g=new Array("taxonomies","custom_image","custom_text");var i=h.data("type");if(c.inArray(i,g)==-1&&c("#ptb_row_wrapper").find('[data-type="'+i+'"]').length>2){if(h.hasClass("ptb_is_metabox")){var l=h.find("input,select,textarea").attr("name");if(l&&c("#ptb_row_wrapper").find('[data-type="'+i+'"] [name="'+l+'"]').length<2){d(h.find("select.ptb-select"));return false}}alert(ptb_submission.module+" "+h.find(".ptb_module_name").text());h.remove();return false}d(h.find("select.ptb-select"))});c(document).on("PTB.template_load",function(i,f){if(f==="frontend"){d(c("#ptb_row_wrapper .ptb-select"));if(c(".ptb_new-themplate").length>0){var h=c("#ptb_cmb_user_email").clone();var j=c("#ptb_cmb_user_name").clone();var g=c("#ptb_cmb_user_password").clone();c(".ptb_back_col.first .ptb_module_holder").append(h).append(j).append(g).find(".ptb_empty_holder_text").hide();c(".ptb_back_module_panel #ptb_cmb_title,\n                    .ptb_back_module_panel #ptb_cmb_user_email,\n                    .ptb_back_module_panel #ptb_cmb_user_name,\n                    .ptb_back_module_panel #ptb_cmb_user_password").remove()}}});c(document).on("PTB.template_select_grid",function(i,g,f){var h=c("#ptb_row_wrapper select.ptb-select");h.each(function(){c(this).closest("div").html(c(this))});d(h)});c(document).ready(function(){d(c("select.ptb-select"));c(".ptb-submission-tabs a").click(function(f){f.preventDefault();if(!c(this).hasClass("nav-tab-active")){c(this).closest(".ptb-submission-tabs").find(".nav-tab-active").removeClass("nav-tab-active");c(this).addClass("nav-tab-active");c(".ptb-submission-tabs- li").hide();c(c(this).attr("href")).show()}});c(".ptb-submission-tabs a").first().trigger("click");c("body").delegate("#ptb-submission-form-save","submit",function(g){g.preventDefault();var f=c(this);c.ajax({url:f.attr("action"),type:"POST",data:f.serialize(),beforeSend:function(){f.addClass("ptb-frontend-wait")},complete:function(){f.removeClass("ptb-frontend-wait")},success:function(h){if(h){f.closest(".ptb_lightbox_inner").fadeOut("normal",function(){c(this).html(h).fadeIn()})}}})});c("body").delegate(".ptb_submission_templates a.ptb_submission_delete","click",function(g){g.preventDefault();if(confirm(ptb_js.template_delete)){var f=c(this).closest("form");c.ajax({url:this,type:"POST",beforeSend:function(){f.addClass("ptb-frontend-wait")},complete:function(){f.removeClass("ptb-frontend-wait")},success:function(h){if(h){h=c(h).find("#the-list").html();c("#ptb-submission-list-form #the-list").html(h)}}})}});a()});var a=function(){if(c.fn.datepicker){var f=function(i,h){var g=c(".wrap");c.ajax({url:i,type:"POST",data:h,beforeSend:function(){g.addClass("ptb-frontend-wait")},complete:function(){g.removeClass("ptb-frontend-wait")},success:function(j){if(j){c("#ptb-submission-posts-wrap").html(j)}}})};c(".ptb-submission-datepicker").datepicker({dateFormat:"yy-mm-dd",maxDate:new Date(),numberOfMonths:1,onSelect:function(g){if(c(this).attr("id")=="ptb-submission-posts-from"){c("#ptb-submission-posts-to").datepicker("option","minDate",g)}else{c("#ptb-submission-posts-from").datepicker("option","maxDate",g)}}});if(c.datepicker.regional[ptb_submission.lng]){c.datepicker.setDefaults(c.datepicker.regional[ptb_submission.lng])}c("#ptb-submission-posts-filter").submit(function(g){g.preventDefault();if(!g.isTrigger){c(this).find('input[name="paged"]').val(0)}f(ajaxurl,c(this).serialize())});c("#ptb-submission-posts-wrap").delegate(".sortable a,.sorted a","click",function(i){i.preventDefault();var h=b(this,"order"),g=b(this,"orderby");c('#ptb-submission-posts-filter input[name="order"]').val(h);c('#ptb-submission-posts-filter input[name="orderby"]').val(g);c("#ptb-submission-posts-filter").trigger("submit")});c("#ptb-submission-posts-wrap").delegate(".pagination-links a","click",function(g){g.preventDefault();c('#ptb-submission-posts-filter input[name="paged"]').val(b(this,"paged"));c("#ptb-submission-posts-filter").trigger("submit")});c("#ptb-submission-posts-wrap").delegate(".column-cb input","change",function(){var g=c("#ptb-submission-posts-wrap").find('input[type="checkbox"]');g.prop("checked",c(this).is(":checked"))});c("#ptb-submission-posts-wrap").delegate("a.ptb-submission-post-action","click",function(g){g.preventDefault();if(c(this).hasClass("ptb-submission-post-delete")&&!confirm(ptb_js.template_delete)){return false}f(this)});c("#ptb-submission-posts-form").delegate('input[type="submit"]',"click",function(h){h.preventDefault();var g=c(this).closest("form"),i=c(this).closest(".bulkactions").find("select option:selected").val();if(i!=-1&&g.find('input[name="posts[]"]:checked').length>0){g.find('input[name="paged"]').val(0);g.find('input[name="method"]').val(i);f(ajaxurl,g.find("input").serialize())}})}else{if(c("#ptb-submission-users-form").length>0){c('#ptb-submission-users-form input[type="submit"]').click(function(h){var g=c(this).closest("form"),i=c(this).closest(".bulkactions").find("select option:selected").val();if(i==-1||g.find('input[name="users[]"]:checked').length==0){h.preventDefault()}})}}}}(jQuery));